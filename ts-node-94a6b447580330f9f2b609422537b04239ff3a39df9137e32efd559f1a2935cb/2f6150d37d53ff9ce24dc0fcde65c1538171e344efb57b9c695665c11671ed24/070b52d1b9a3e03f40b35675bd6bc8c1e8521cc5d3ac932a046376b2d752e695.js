"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const nodemailer = require("nodemailer");
const xoauth2_1 = require("xoauth2");
const { XOAUTH2_ACCESS_URL, XOAUTH2_HEADERS, XOAUTH2_PARAMS } = process.env;
let transport;
function initMailer() {
    transport = nodemailer.createTransport({
        service: 'Gmail',
        auth: {
            xoauth2: xoauth2_1.createXOAuth2Generator({
                accessUrl: XOAUTH2_ACCESS_URL,
                customHeaders: JSON.parse(XOAUTH2_HEADERS || '{}'),
                customParams: JSON.parse(XOAUTH2_PARAMS || '{}')
            })
        }
    });
    console.log('Mailer initialized.');
}
exports.initMailer = initMailer;
function send(mailOptions) {
    transport.sendMail(mailOptions, (error, response) => {
        if (error) {
            console.log(error);
        }
        console.log('Message sent:', response);
    });
}
exports.send = send;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL21udC9jL1VzZXJzL0plZmYvUGVlci1HZW5pdXMvc2VydmVyL2VtYWlsL21haWxlci50cyIsInNvdXJjZXMiOlsiL21udC9jL1VzZXJzL0plZmYvUGVlci1HZW5pdXMvc2VydmVyL2VtYWlsL21haWxlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHlDQUEwQztBQUMxQyxxQ0FBaUQ7QUFFakQsTUFBTSxFQUFFLGtCQUFrQixFQUFFLGVBQWUsRUFBRSxjQUFjLEVBQUUsR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDO0FBRTVFLElBQUksU0FBUyxDQUFDO0FBRWQ7SUFDQyxTQUFTLEdBQUcsVUFBVSxDQUFDLGVBQWUsQ0FBQztRQUN0QyxPQUFPLEVBQUUsT0FBTztRQUNoQixJQUFJLEVBQUU7WUFDTCxPQUFPLEVBQUUsZ0NBQXNCLENBQUM7Z0JBQy9CLFNBQVMsRUFBRSxrQkFBa0I7Z0JBQzdCLGFBQWEsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLGVBQWUsSUFBSSxJQUFJLENBQUM7Z0JBQ2xELFlBQVksRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLGNBQWMsSUFBSSxJQUFJLENBQUM7YUFDaEQsQ0FBQztTQUNGO0tBQ1MsQ0FBQyxDQUFDO0lBRWIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO0FBQ3BDLENBQUM7QUFiRCxnQ0FhQztBQUVELGNBQXFCLFdBQVc7SUFDL0IsU0FBUyxDQUFDLFFBQVEsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxLQUFLLEVBQUUsUUFBUTtRQUMvQyxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO1lBQ1gsT0FBTyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNwQixDQUFDO1FBRUQsT0FBTyxDQUFDLEdBQUcsQ0FBQyxlQUFlLEVBQUUsUUFBUSxDQUFDLENBQUM7SUFDeEMsQ0FBQyxDQUFDLENBQUM7QUFDSixDQUFDO0FBUkQsb0JBUUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyAgbm9kZW1haWxlciBmcm9tICdub2RlbWFpbGVyJztcbmltcG9ydCB7IGNyZWF0ZVhPQXV0aDJHZW5lcmF0b3IgfSBmcm9tICd4b2F1dGgyJztcblxuY29uc3QgeyBYT0FVVEgyX0FDQ0VTU19VUkwsIFhPQVVUSDJfSEVBREVSUywgWE9BVVRIMl9QQVJBTVMgfSA9IHByb2Nlc3MuZW52O1xuXG5sZXQgdHJhbnNwb3J0O1xuXG5leHBvcnQgZnVuY3Rpb24gaW5pdE1haWxlcigpIHtcblx0dHJhbnNwb3J0ID0gbm9kZW1haWxlci5jcmVhdGVUcmFuc3BvcnQoe1xuXHRcdHNlcnZpY2U6ICdHbWFpbCcsXG5cdFx0YXV0aDoge1xuXHRcdFx0eG9hdXRoMjogY3JlYXRlWE9BdXRoMkdlbmVyYXRvcih7XG5cdFx0XHRcdGFjY2Vzc1VybDogWE9BVVRIMl9BQ0NFU1NfVVJMLFxuXHRcdFx0XHRjdXN0b21IZWFkZXJzOiBKU09OLnBhcnNlKFhPQVVUSDJfSEVBREVSUyB8fCAne30nKSxcblx0XHRcdFx0Y3VzdG9tUGFyYW1zOiBKU09OLnBhcnNlKFhPQVVUSDJfUEFSQU1TIHx8ICd7fScpXG5cdFx0XHR9KVxuXHRcdH1cblx0fSBhcyBvYmplY3QpO1xuXHRcblx0Y29uc29sZS5sb2coJ01haWxlciBpbml0aWFsaXplZC4nKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNlbmQobWFpbE9wdGlvbnMpIHtcblx0dHJhbnNwb3J0LnNlbmRNYWlsKG1haWxPcHRpb25zLCAoZXJyb3IsIHJlc3BvbnNlKSA9PiB7XG5cdFx0aWYgKGVycm9yKSB7XG5cdFx0XHRjb25zb2xlLmxvZyhlcnJvcik7XG5cdFx0fVxuXHRcdFxuXHRcdGNvbnNvbGUubG9nKCdNZXNzYWdlIHNlbnQ6JywgcmVzcG9uc2UpO1xuXHR9KTtcbn1cbiJdfQ==