"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const httpStatus = require("http-status-codes");
const jwt = require("jsonwebtoken");
const { JWT_SECRET, JWT_EXPIRE } = process.env;
const secret = new Buffer(JWT_SECRET, 'base64');
exports.createSessionToken = (id) => {
    return jwt.sign({ id }, secret, { expiresIn: parseInt(JWT_EXPIRE) });
};
exports.verifySessionToken = (request, response, next) => {
    try {
        request.body.user = jwt.verify(request.cookies.sessionJWT, secret);
        next();
    }
    catch (err) {
        response.status(httpStatus.UNAUTHORIZED).json({ reason: 'Invalid session' });
    }
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL21udC9jL1VzZXJzL0plZmYvUGVlci1HZW5pdXMvc2VydmVyL3JvdXRlci9taXNjL2F1dGgudHMiLCJzb3VyY2VzIjpbIi9tbnQvYy9Vc2Vycy9KZWZmL1BlZXItR2VuaXVzL3NlcnZlci9yb3V0ZXIvbWlzYy9hdXRoLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsZ0RBQWdEO0FBQ2hELG9DQUFvQztBQUlwQyxNQUFNLEVBQUUsVUFBVSxFQUFFLFVBQVUsRUFBRSxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUM7QUFFL0MsTUFBTSxNQUFNLEdBQUcsSUFBSSxNQUFNLENBQUMsVUFBVSxFQUFFLFFBQVEsQ0FBQyxDQUFDO0FBRW5DLFFBQUEsa0JBQWtCLEdBQUcsQ0FBQyxFQUFVO0lBQzVDLE1BQU0sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUUsRUFBRSxFQUFZLEVBQUUsTUFBTSxFQUFFLEVBQUUsU0FBUyxFQUFFLFFBQVEsQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDLENBQUM7QUFDaEYsQ0FBQyxDQUFDO0FBRVcsUUFBQSxrQkFBa0IsR0FBRyxDQUFDLE9BQWdCLEVBQUUsUUFBa0IsRUFBRSxJQUFrQjtJQUMxRixJQUFJLENBQUM7UUFDSixPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksR0FBRyxHQUFHLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsVUFBVSxFQUFFLE1BQU0sQ0FBQyxDQUFDO1FBQ25FLElBQUksRUFBRSxDQUFDO0lBQ1IsQ0FBQztJQUFDLEtBQUssQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDZCxRQUFRLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxZQUFZLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxNQUFNLEVBQUUsaUJBQWlCLEVBQUUsQ0FBQyxDQUFDO0lBQzlFLENBQUM7QUFDRixDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBodHRwU3RhdHVzIGZyb20gJ2h0dHAtc3RhdHVzLWNvZGVzJztcbmltcG9ydCAqIGFzIGp3dCBmcm9tICdqc29ud2VidG9rZW4nO1xuXG5pbXBvcnQgeyBOZXh0RnVuY3Rpb24sIFJlcXVlc3QsIFJlc3BvbnNlIH0gZnJvbSAnZXhwcmVzcyc7XG5cbmNvbnN0IHsgSldUX1NFQ1JFVCwgSldUX0VYUElSRSB9ID0gcHJvY2Vzcy5lbnY7XG5cbmNvbnN0IHNlY3JldCA9IG5ldyBCdWZmZXIoSldUX1NFQ1JFVCwgJ2Jhc2U2NCcpO1xuXG5leHBvcnQgY29uc3QgY3JlYXRlU2Vzc2lvblRva2VuID0gKGlkOiBzdHJpbmcpOiBzdHJpbmcgPT4ge1xuXHRyZXR1cm4gand0LnNpZ24oeyBpZCB9IGFzIG9iamVjdCwgc2VjcmV0LCB7IGV4cGlyZXNJbjogcGFyc2VJbnQoSldUX0VYUElSRSkgfSk7XG59O1xuXG5leHBvcnQgY29uc3QgdmVyaWZ5U2Vzc2lvblRva2VuID0gKHJlcXVlc3Q6IFJlcXVlc3QsIHJlc3BvbnNlOiBSZXNwb25zZSwgbmV4dDogTmV4dEZ1bmN0aW9uKSA9PiB7XG5cdHRyeSB7XG5cdFx0cmVxdWVzdC5ib2R5LnVzZXIgPSBqd3QudmVyaWZ5KHJlcXVlc3QuY29va2llcy5zZXNzaW9uSldULCBzZWNyZXQpO1xuXHRcdG5leHQoKTtcblx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0cmVzcG9uc2Uuc3RhdHVzKGh0dHBTdGF0dXMuVU5BVVRIT1JJWkVEKS5qc29uKHsgcmVhc29uOiAnSW52YWxpZCBzZXNzaW9uJyB9KTtcblx0fVxufTtcbiJdfQ==